-- 1) Faça uma listagem do cardápio ordenada por nome;
select * from cardapio order by nome_cafe ASC;

-- 2) Apresente todas as comandas (código, data, mesa e nome do cliente) e os itens da comanda (código comanda, nome do café, descricão, quantidade, preço unitário e preço total do café) destas ordenados data e código da comanda e, também o nome do café;
SELECT co.id_comanda AS codigo_comanda, co.data as data_comanda, co.numero_mesa, 
co.nome_cliente, ca.nome_cafe, ca.descricao, ca.preco_unitario,ic.quantidade,
 (ic.quantidade*ca.preco_unitario) as preco_total    
 FROM cardapio ca
 INNER JOIN item_comanda ic
 ON ca.id_cardapio = ic.fk_idcardapio
 INNER JOIN comanda co
 ON ic.fk_idcomanda = co.id_comanda
 ORDER BY
 data_comanda,
 codigo_comanda,
 nome_cafe;

-- 3) Liste todas as comandas (código, data, mesa e nome do cliente) mais uma coluna com o valor total da comanda. Ordene por data esta listagem;
SELECT co.id_comanda as codigo_comanda, co.data as data_comanda, co.numero_mesa, co.nome_cliente, sum(ca.preco_unitario * ic.quantidade) as valor_total
 FROM cardapio ca
 INNER JOIN item_comanda ic
 ON ca.id_cardapio = ic.fk_idcardapio
 INNER JOIN comanda co
 ON ic.fk_idcomanda = co.id_comanda
 GROUP BY co.id_comanda, co.data, co.numero_mesa, co.nome_cliente
 ORDER BY
 data_comanda;

 
-- 4) Faça a mesma listagem das comandas da questão anterior (6), mas traga apenas as comandas que possuem mais do que um tipo de café na comanda;
SELECT
    co.id_comanda AS codigo_comanda,
    co.nome_cliente,
    co.numero_mesa,
    co.data as data_comanda
FROM comanda co
JOIN item_comanda ic 
    ON ic.fk_idcomanda = co.id_comanda
JOIN cardapio ca
    ON ca.id_cardapio = ic.fk_idcardapio
GROUP BY
    codigo_comanda,
    co.nome_cliente,
    co.numero_mesa,
    data_comanda
HAVING COUNT(DISTINCT ca.nome_cafe) > 1;


-- 5) Qual o total de faturamento por data? ordene por data esta consulta.
SELECT
    co.data as data_comanda,
    SUM(ca.preco_unitario * ic.quantidade) AS faturamento
FROM cardapio ca
INNER JOIN item_comanda ic
    ON ca.id_cardapio = ic.fk_idcardapio
INNER JOIN comanda co
    ON ic.fk_idcomanda = co.id_comanda
GROUP BY                  
    co.data
ORDER BY
    data_comanda;